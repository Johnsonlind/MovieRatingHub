/* ========================================== */
/* 滚动性能优化样式 */
/* ========================================== */
@media (prefers-reduced-motion: reduce) {
  .gentle-scroll {
    transform: none !important;
    will-change: auto !important;
  }
}

/* 确保图片未加载时完全隐藏，避免占位符闪烁 */
img[style*="opacity: 0"] {
  visibility: hidden;
}

/* 图片容器优化 - GPU 加速和渲染优化 */
[class*="aspect-"] {
  /* 确保容器有固定尺寸，避免布局抖动 */
  contain: layout style paint;
  will-change: contents;
  transform: translateZ(0); /* GPU 加速 */
  backface-visibility: hidden;
  perspective: 1000px;
}

[class*="aspect-"] img {
  will-change: opacity, transform;
  backface-visibility: hidden;
  transform: translateZ(0); /* GPU 加速 */
  image-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* 优化滚动性能 - 使用 content-visibility 和 contain */
/* 这些优化适用于所有滚动容器，不仅仅是 .gentle-scroll */
.gentle-scroll,
[class*="glass-card"],
.grid {
  transform: translateZ(0); /* GPU 加速 */
  will-change: scroll-position;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

/* 优化：只在非关键内容上使用 content-visibility，避免影响滚动 */
/* 注意：Lenis 需要能够正确计算滚动位置，所以对滚动容器本身不使用 content-visibility */
.gentle-scroll > *:not(img):not([class*="group"]):not(.grid),
[class*="glass-card"] > *:not(img):not([class*="group"]):not(.grid) {
  /* 使用 content-visibility 延迟渲染不可见内容（RAIL 性能优化） */
  content-visibility: auto;
  contain-intrinsic-size: auto 300px;
  /* 限制重排和重绘范围（避免布局抖动） */
  contain: layout style paint;
}

/* 网格容器优化 - 确保流畅滚动 */
.grid {
  contain: layout style;
  will-change: contents;
}

/* 图片卡片容器优化 */
[class*="group"] {
  contain: layout style;
  transform: translateZ(0); /* GPU 加速 */
}

/* 优化滚动时的图片加载 */
.gentle-scroll img {
  transform: translateZ(0); /* GPU 加速 */
  will-change: opacity;
  backface-visibility: hidden;
}

/* 确保图片容器在滚动时保持稳定 */
.gentle-scroll [class*="aspect-"] {
  /* 固定尺寸，避免布局重排 */
  min-height: 0;
  min-width: 0;
  transform: translateZ(0); /* GPU 加速 */
  will-change: transform;
}
